<!doctype html>
<html class="no-js" lang="pt-br">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>SenSolutions</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/png" href="img/logo-resp1.png">
   
    
    <link href="css/googleapis.css" rel="stylesheet">
    <link rel="stylesheet" href="css/estilo.css">
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="vendor/fontawesome-free/css/all.css">
    <link href="css/sb-admin-2.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/default-css.css">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/responsive.css">
    <link rel="stylesheet" href="css/main.css">

    <!-- modernizr css -->
</head>

<body onload="atualizarGrafico()">
    <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
    <!-- preloader area start -->
    <div id="preloader">
        <div class="loader"></div>
    </div>
    <!-- preloader area end -->
    <!-- page container area start -->
    <div class="page-container">
        <!-- sidebar menu area start -->
        <div class="sidebar-menu">
            <div class="sidebar-header">
                <div class="logo">
                    <a href="Dashboard.html"><img src="img/logo-branco.png" alt="logo"></a>
                </div>
            </div>
            <div class="main-menu">
                <div class="menu-inner ">
                    <nav>
                        <ul class="metismenu " id="menu">
                            <li><a class="text-light" href="Dashboard.html"><i class="fas fa-home text-primary "></i>
                                    Home</a></li>
                            <li class="active " Sensores>
                                <a href="javascript:void(0)" aria-expanded="true"><i class="fas fa-chart-line"></i>
                                    Gráficos</a>
                                <ul class="collapse ">
                                    <li><a class="scroll" href="#verview-shart" onclick="trocar(grafico,sensores,local,usuario)">Em
                                            Linhas</a></li>
                                    <li><a class="scroll" href="#ambarchart3" onclick="trocar(grafico,sensores,local,usuario)">Em
                                            Barra</a></li>
                                </ul>
                            </li>
                            <li class="active " cadastrar>
                                <a href="javascript:void(0)" aria-expanded="true"><i class="fab fa-wpforms"></i>
                                    Cadastrar</a>
                                <ul class="collapse ">
                                    <li><a class="" href="#sensores" onclick="trocar(sensores,usuario,local,grafico)">Sensores</a></li>
                                    <li><a class="" href="#local" onclick="trocar(local,sensores,usuario,grafico)">Locais</a></li>
                                    <li><a class="" href="#usuario" onclick="trocar(usuario,sensores,local,grafico)">Usuarios</a></li>
                                </ul>
                            </li>

                        </ul>
                    </nav>
                </div>
            </div>
        </div>
        <!-- sidebar menu area end -->
        <!-- main content area start -->
        <div class="main-content">
            <!-- header area start -->
            <div class="header-area">
                <div class="row align-items-center">
                    <!-- nav and search button -->
                    <div class="col-md-11 col-sm-8 clearfix">
                        <div class="nav-btn pull-left">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>

                    </div>
                    <!-- profile info & task notification -->

                </div>
            </div>
            <!-- header area end -->

             <!-- page title area start -->
             <div class="page-title-area">
                    <div class="row align-items-center">
                        <div class="col-sm-6">
                            <div class="breadcrumbs-area clearfix">
                                <h4 class="page-title pull-left">Dashboard</h4>
                                <ul class="breadcrumbs pull-left">
                                    <li><a href="index.html">Home</a></li>
                                    <li><span>Dashboard</span></li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-sm-6 clearfix">
                            <div class="user-profile pull-right">
                                <img class="avatar user-thumb" src="img/avatar.png" alt="avatar">
                                <h4 class="user-name dropdown-toggle" data-toggle="dropdown"><span id="b_usuario"></span> <i class="fa fa-angle-down"></i></h4>
                                <div class="dropdown-menu">
                                    <a class="dropdown-item" onclick="logoff()">Log Out</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- page title area end -->

         
            <div class="main-content-inner">
                    <div class="row" style="display: none" id="usuario">
                            <div class="col-lg-7 mx-auto">
                                <div class="card o-hidden border-1  my-5">
                                    <div class="card-body p-0">
                                        <div class="p-5">
                                            <div class="text-center">
                                                <h1 class="h4 text-gray-900 mb-4">Cadastre outro usuário.</h1>
                                            </div>
                                            <form class="user">
                                                <div class="form-group">
                                                    <div class="form-group">
                                                        <input type="text" class="form-control form-control-user" id="exampleInputEmail"
                                                            placeholder="Digite seu nome completo.">
                                                    </div>
                                                    <div class="form-group">
                                                        <input type="text" class="form-control form-control-user" id="exampleInputEmail"
                                                            placeholder="Digite seu e-mail.">
                                                    </div>
                                                    <div class="form-group row">
                                                        <div class="col-sm-6 mb-3 mb-sm-0">
                                                            <input type="password" class="form-control form-control-user" id="exampleInputPassword"
                                                                placeholder="Sua Senha.">
                                                        </div>
                                                        <div class="col-sm-6">
                                                            <input type="text" class="form-control form-control-user" id="exampleRepeatPassword"
                                                                placeholder="Repita a senha.">
                                                        </div>
        
                                                    </div>
        
        
                                                </div>
                                                <a href="Dashboard.html" class="btn btn-outline-primary btn-user btn-block">
                                                    Registrar.
                                                </a>
                                            </form>

                                            <div class="text-center">
        
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
        
        
                        </div>
                <!-- sales report area start -->
                <div class="sales-report-area mt-5 mb-5">
                    <div class="row" style="display: none" id="sensores">
                        <div class="col-lg-7 mx-auto">
                            <div class="card o-hidden border-1  my-5">
                                <div class="card-body p-0">
                                    <div class="p-5">
                                        <div class="text-center">
                                            <h1 class="h4 text-gray-900 mb-4">Faça o registro dos sensores.</h1>
                                        </div>
                                        <form class="user">
                                            <div class="form-group">
                                                <div class="form-group">
                                                    <input type="text" class="form-control form-control-user" id="exampleInputEmail"
                                                        placeholder="Digite o número serial do sensor.">
                                                </div>
                                                <div class="form-group">
                                                    <input type="text" class="form-control form-control-user" id="exampleInputEmail"
                                                        placeholder="Digite a ala onde será posicionado.">
                                                </div>
                                            </div>
                                            <a href="Dashboard.html" class="btn btn-outline-primary btn-user btn-block">
                                                Registrar.
                                            </a>
                                        </form>
                                        <div class="text-center">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-12">
                            <!-- Barra de pesquisa -->
                            <div class="row">
                                <div class="col-md-3">
                                    <h2 class="text-center">Itens</h2>

                                </div>

                                <div class="col-md-6">
                                    <div class="input-group">
                                        <input name="data[search]" class="form-control form-control-user" id="search"
                                            type="text" placeholder="Pesquisar Itens...">

                                        <span class="input-group-btn">
                                            <button class="btn btn-primary pull-left" type="submit">Pesquisar
                                                <span class="glyphicon glyphicon-search"></span>
                                            </button>
                                        </span>
                                    </div>
                                </div>

                                <div class="col-md-3">
                                    <a href="#" class="btn btn-primary pull-left">Novo Item</a>
                                </div>
                            </div> <!-- /#top -->

                            <div id="list" class="row">
                                <div class="table-responsive col-md-12">
                                    <table class="table table-striped" cellspacing="0" cellpadding="0">
                                        <thead>
                                            <tr class="text-center">
                                                <th>ID</th>
                                                <th>Header 1</th>
                                                <th>Header 2</th>
                                                <th>Header 3</th>
                                                <th class="actions">Ações</th>
                                </div>

                                </tr>
                                </thead>
                                <tbody>

                                    <tr class="text-center">
                                        <td>1001</td>
                                        <td>Lorem ipsum dolor sit amet, consectetur adipiscing</td>
                                        <td>Jes</td>
                                        <td>01/01/2015</td>
                                        <td class="actions">
                                            <a class="btn btn-info btn-xs" href="#">Editar</a>
                                            <a class="btn btn-primary btn-xs" href="#">Excluir</a>
                                        </td>
                                    </tr>

                                </tbody>
                                </table>

                            </div>
                        </div>
                        <!-- /#list -->
                    </div>
                </div>

                <div class="row" style="display: none" id="local">
                    <div class="col-lg-7 mx-auto">
                        <div class="card o-hidden border-1  my-5">
                            <div class="card-body p-0">
                                <div class="p-5">
                                    <div class="text-center">
                                        <h1 class="h4 text-gray-900 mb-4">Cadastre um local.</h1>
                                    </div>
                                    <form class="user">
                                        <div class="form-group">
                                            <div class="form-group">
                                                <input type="text" class="form-control form-control-user" id="exampleInputEmail"
                                                    placeholder="Digite o nome da empresa.">
                                            </div>
                                            <div class="form-group">
                                                <input type="text" class="form-control form-control-user" id="exampleInputEmail"
                                                    placeholder="Digite o CEP.">
                                            </div>
                                            <div class="form-group row">
                                                <div class="col-sm-6 mb-3 mb-sm-0">
                                                    <input type="password" class="form-control form-control-user" id="exampleInputPassword"
                                                        placeholder="Digite o número.">
                                                </div>
                                                <div class="col-sm-6">
                                                    <input type="text" class="form-control form-control-user" id="exampleRepeatPassword"
                                                        placeholder="Digite o logradouro.">
                                                </div>

                                            </div>


                                        </div>
                                        <a href="Dashboard.html" class="btn btn-outline-primary btn-user btn-block">
                                            Registrar local.
                                        </a>
                                    </form>
                                    <div class="text-center">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="row">
                            <div class="col-md-3">
                                <h2 class="text-center">Itens</h2>

                            </div>

                            <div class="col-md-6">
                                <div class="input-group">
                                    <input name="data[search]" class="form-control form-control-user" id="search" type="text"
                                        placeholder="Pesquisar Itens...">

                                    <span class="input-group-btn">
                                        <button class="btn btn-primary pull-left" type="submit">Pesquisar
                                            <span class="glyphicon glyphicon-search"></span>
                                        </button>
                                    </span>
                                </div>
                            </div>

                            <div class="col-md-3">
                                <a href="#" class="btn btn-primary pull-left">Novo Item</a>
                            </div>
                        </div> <!-- /#top -->

                        <div id="list" class="row">
                            <div class="table-responsive col-md-12">
                                <table class="table table-striped" cellspacing="0" cellpadding="0">
                                    <thead>
                                        <tr class="text-center">
                                            <th>ID</th>
                                            <th>Header 1</th>
                                            <th>Header 2</th>
                                            <th>Header 3</th>
                                            <th class="actions">Ações</th>
                            </div>

                            </tr>
                            </thead>
                            <tbody>

                                <tr class="text-center">
                                    <td>1001</td>
                                    <td>Lorem ipsum dolor sit amet, consectetur adipiscing</td>
                                    <td>Jes</td>
                                    <td>01/01/2015</td>
                                    <td class="actions">
                                        <a class="btn btn-info btn-xs" href="#">Editar</a>
                                        <a class="btn btn-primary btn-xs" href="#">Excluir</a>
                                    </td>
                                </tr>

                            </tbody>
                            </table>

                        </div>
                    </div>
                </div>
               
            </div>
            <!-- sales report area end -->
            <!-- overview area start -->
            <div class="row" id="grafico">
                <div class="col-xl-12 col-lg-12">
                    <div class="card">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-center">
                                <h4 class="header-title mb-0">Overview</h4>
                            </div>



                            <!-- <div  id="img_temp_umid">
                                        <img src="img/tempUmid.png" alt="">
                                </div> -->
                            <!-- colocar aqui os GRAFICOS -->
                            <div style="width:75%;">
                                <div id="div_aguarde">Dados sendo obtidos...</div>
                                <canvas id="canvas_grafico"></canvas>
                            </div>
                           
                            
                            <div id="verview-shart"></div>
                            <div class="row">
                                <div class="col-lg-12 col-sm-12 mx-auto">

                                    <div class="mx-auto">
                                        <div class="card-header mx-4">
                                            <h4 class="m-0 font-weight-bold text-primary text-center">Estatísticas</h4>
                                        </div>
                                        <div class="card-body">
                                            <div class="table-responsive">
                                                <table class="table table-bordered" id="dataTable">
                                                    <thead>
                                                        <tr>
                                                            <th>Valor Mínimo</th>
                                                            <th>25% Percentil</th>
                                                            <th>Média</th>
                                                            <th>Ponto Médio</th>
                                                            <th>75% Percentil</th>
                                                            <th>Valor Máximo</th>
                                                        </tr>
                                                    </thead>

                                                    <tbody>

                                                        <tr>
                                                            <td>30</td>
                                                            <td>31</td>
                                                            <td>31,9</td>
                                                            <td>32</td>
                                                            <td>33</td>
                                                            <td>34</td>
                                                        </tr>
                                                    </tbody>

                                                </table>
                                                <div class="">
                                                    <div class="table-responsive">
                                                        <table class="table table-bordered" id="dataTable">
                                                            <thead>
                                                                <tr>
                                                                    <th>Valor Mínimo</th>
                                                                    <th>25% Percentil</th>
                                                                    <th>Média</th>
                                                                    <th>Ponto Médio</th>
                                                                    <th>75% Percentil</th>
                                                                    <th>Valor Máximo</th>
                                                                </tr>
                                                            </thead>

                                                            <tbody>

                                                                <tr>
                                                                    <td>59</td>
                                                                    <td>65,25</td>
                                                                    <td>68,61</td>
                                                                    <td>59</td>
                                                                    <td>70</td>
                                                                    <td>80</td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-12 col-sm-12 mx-auto">
                                <div class="text-center h3 mb-4">Graficos em barras</div>
                                <div id="ambarchart3" class="mt-4"></div>
                                <div id="ambarchart2" class="mt-4"></div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
  
    <!-- main content area end -->
    <!-- Start Footer Area -->
    <footer class="footer-area section-gap">
        <div class="container">
            <div class="row">
                <div class="col-lg-3 col-md-3 single-footer-widget">
                    <h4><u>Ajuda</u></h4>
                    <ul>
                        <li><a href="Ajuda.html">Dúvidas Frequentes</a></li>
                        <li><a href="Ajuda.html">FAQ</a></li>

                    </ul>
                </div>
                <div class="col-lg-3 col-md-3 single-footer-widget">
                    <h4><u>Institucional</u></h4>
                    <ul>
                        <li><a href="index.html">Missão</a></li>
                        <li><a href="index.html">Visão</a></li>
                        <li><a href="index.html">Valores</a></li>

                    </ul>
                </div>
                <div class="col-lg-3 col-md-3 single-footer-widget">
                    <h4><u>Projetos</u></h4>
                    <ul>
                        <li><a href="Projeto-Avícola.html">Avícola</a></li>
                        <li><a href="Dashboard.html">Dashboards</a></li>
                    </ul>
                </div>
                <div class="col-lg-3 col-md-3 single-footer-widget">
                    <h4><u>Redes Sociais</u></h4>


                    <a href="#"><i class="fab fa-twitter fa-2x"></i></a>
                    <a href="#"><i class="fab fa-facebook fa-2x"></i></a>
                    <a target="_Blank" href="https://github.com/BandTec/SenSolutions"><i class="fab fa-github fa-2x"></i></a>
                    <a href="#"><i class="fab fa-trello fa-2x"></i></a>


                </div>

            </div>
            <div class="footer-bottom row align-items-center">
                <p class="footer-text m-0 col-lg-6 col-md-12">&copy; Copyright 2019. All rights reserved
                    SenSolutions
                </p>

            </div>
        </div>

    </footer>
    <!-- End Footer Area - ->
    </div>
page container area end -->

    <!-- jquery latest version -->
    <script src="js/vendor/jquery-2.2.4.min.js"></script>
    <!-- bootstrap 4 js -->
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <!-- <script src="js/owl.carousel.min.js"></script> -->
    <!-- <script src="js/metisMenu.min.js"></script> -->
    <!-- <script src="js/jquery.slimscroll.min.js"></script> -->
    <!-- <script src="js/jquery.slicknav.min.js"></script> -->
    <script src="js/main.js"></script>



    <!-- start chart js -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.min.js"></script> -->

    <!-- start highcharts js -->
    <!-- <script src="https://code.highcharts.com/highcharts.js"></script> -->
    <!-- start zingchart js -->
    <!-- <script src="https://cdn.zingchart.com/zingchart.min.js"></script> -->
    <!-- <script>
         zingchart.MODULESDIR = "https://cdn.zingchart.com/modules/";
        ZC.LICENSE = ["569d52cefae586f634c54f86dc99e6a9", "ee6b7db5b51705a13dc2339db3edaf6d"];
    </script>  -->
    <!-- all line chart activation -->
    <!-- <script src="js/line-chart.js"></script> -->
    <!-- others plugins -->
    <script src="js/plugins.js"></script>
    <script src="js/scripts.js"></script>
    <script src="js/scripts.min.js"></script>
    <!-- start amchart js 
    <script src="https://www.amcharts.com/lib/3/amcharts.js"></script>
    <script src="https://www.amcharts.com/lib/3/pie.js"></script>
    <script src="https://www.amcharts.com/lib/3/serial.js"></script>
    <script src="https://www.amcharts.com/lib/3/plugins/animate/animate.min.js"></script>
    <script src="https://www.amcharts.com/lib/3/plugins/export/export.min.js"></script>
    <script src="https://www.amcharts.com/lib/3/themes/light.js"></script>
       all bar chart activation --> 
    <!-- <script src="js/bar-chart.js"></script> -->
    
    <script type="text/javascript" src="https://www.chartjs.org/dist/2.8.0/Chart.min.js"></script>
    <script type="text/javascript" src="https://www.chartjs.org/samples/latest/utils.js"></script>
    

</body>

</html>
<script>

        var usuario;
        var exibiu_grafico = false;
    
        verificarAutenticacao();
    
    
        function verificarAutenticacao() {
            usuario = sessionStorage.usuario_bandtec;
            if (usuario == undefined) {
                window.location.href = 'login.html';
            } else {
                b_usuario.innerHTML = usuario;
            }
        }
    
        function logoff() {
            sessionStorage.removeItem('usuario_bandtec');
            verificarAutenticacao();
        }
    
        // só mexer se quiser alterar o tempo de atualização
        // ou se souber o que está fazendo!
        function atualizarGrafico() {
            obterDadosGrafico();
            setTimeout(atualizarGrafico, 10000);
        }
    
        // altere aqui as configurações do gráfico
        // (tamanhos, cores, textos, etc)
        function configurarGrafico() {
            var configuracoes = {
                responsive: true,
                animation: exibiu_grafico ? false : {duration: 1500},
                hoverMode: 'index',
                stacked: false,
                title: {
                    display: true,
                    text: 'Histórico recente de temperatura e umidade'
                },
                scales: {
                    yAxes: [{
                        type: 'linear', // only linear but allow scale type registration. This allows extensions to exist solely for log scale for instance
                        display: true,
                        position: 'left',
                        id: 'y-temperatura',
                    }, {
                        type: 'linear', // only linear but allow scale type registration. This allows extensions to exist solely for log scale for instance
                        display: true,
                        position: 'right',
                        id: 'y-umidade',
    
                        // grid line settings
                        gridLines: {
                            drawOnChartArea: false, // only want the grid lines for one axis to show up
                        },
                    }],
                }
            };
    
            exibiu_grafico = true;
    
            return configuracoes;
        }
    
        // altere aqui como os dados serão exibidos
        // e como são recuperados do BackEnd
        function obterDadosGrafico() {
    
            // neste JSON tem que ser 'labels', 'datasets' etc, 
            // porque é o padrão do Chart.js
            var dados = {
                labels: [],
                datasets: [
                    {
                        yAxisID: 'y-temperatura',
                        label: 'Temperatura',
                        borderColor: window.chartColors.red,
                        backgroundColor: window.chartColors.red,
                        fill: false,
                        data: []
                    },
                    {
                        yAxisID: 'y-umidade',
                        label: 'Umidade',
                        borderColor: window.chartColors.blue,
                        backgroundColor: window.chartColors.blue,
                        fill: false,
                        data: []
                    }
                ]
            };
    
            fetch('/leituras/ultimas', { cache: 'no-store' }).then(function (response) {
                if (response.ok) {
                    response.json().then(function (resposta) {
    
                        console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
    
                        resposta.reverse();
    
                        for (i = 0; i < resposta.length; i++) {
                            var registro = resposta[i];
                        
                            // aqui, após 'registro.' use os nomes 
                            // dos atributos que vem no JSON 
                            // que gerou na consulta ao banco de dados
    
                            dados.labels.push(registro.dataHora);
    
                            dados.datasets[0].data.push(registro.temperatura);
                            dados.datasets[1].data.push(registro.umidade);
                        }
                        console.log(JSON.stringify(dados));
    
                        div_aguarde.style.display = 'none';
    
                        plotarGrafico(dados);
                    });
                } else {
                    console.error('Nenhum dado encontrado ou erro na API');
                }
            })
                .catch(function (error) {
                    console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
                });
    
        }
    
        // só altere aqui se souber o que está fazendo!
        function plotarGrafico(dados) {
            console.log('iniciando plotagem do gráfico...');
    
            var ctx = canvas_grafico.getContext('2d');
            window.grafico_linha = Chart.Line(ctx, {
                data: dados,
                options: configurarGrafico()
            });
        }
    
    </script>